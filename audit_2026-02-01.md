# Audit Report (2026-02-01)

## Executive Summary
This audit covers the "DeSci & Compliance" milestone (v0.5.1). The system is functional but exhibits typical "Alpha" characteristics, particularly in error handling and mock dependencies.

## 1. Findings

### P0: Critical (Blocking Production)
- **Dependency Hallucination:** `backend/functions/package.json` specifies `typescript ^5.9.3`, which does not exist. This breaks `npm install` in fresh environments.
- **Migration Hygiene:** `vault/migrations/001_initial.sql` was modified in-place to add `investment_id`. This corrupts migration checksums for existing databases.
- **Mobile Build:** `frontend/ideacapital/lib/widgets/vib3_watermark.dart` uses `dart:ui_web`. While conditional imports were added, verifying the `pubspec.yaml` dependencies for `web` vs `mobile` is crucial to avoid tree-shaking errors on iOS.

### P1: High (Safety & Compliance)
- **Vault Floating Point Math:** `vault/src/routes/dividends.rs` uses `f64` for financial calculations (`compliance_fee_splits`). This risks precision errors. **Recommendation:** Switch to `rust_decimal::Decimal` for all currency math.
- **Hardcoded Secrets in Tests:** `scripts/test_integration_vault.py` and `contracts/scripts/deploy_amoy.ts` contain hardcoded private keys/addresses. While these are "testnet/dev" keys, they set a bad precedent.

### P2: Optimization
- **Mock Over-reliance:** The Brain's `zkp_service.py` and `llm_service.py` heavily rely on mocks. The "Real Implementation" is stubbed.
- **Frontend Performance:** `Vib3Watermark` on mobile uses `CustomPainter` which is CPU-bound. On older devices, complex geometry might drop frames.

## 2. Remediation Plan

### Immediate Fixes (v0.5.2)
1.  **Downgrade TypeScript:** Set `package.json` to `~5.4.0`.
2.  **Fix Vault Math:** Refactor `dividends.rs` to use `Decimal` for fee calculations.
3.  **Clean Migrations:** Create `003_fix_investment_schema.sql` and revert `001` to its original state (if aiming for strict purity), or acknowledge `001` as the new "Genesis" for v0.6.0.

## 3. Strategic Recommendations
- **ZKP Circuit:** The current `novelty.circom` is a placeholder. It needs to be compiled to `.wasm` and `.zkey` and integrated with `snarkjs` for the next milestone.
- **Liquid Democracy:** The `Governance.sol` contract is a stub. It needs `checkpoint` logic to securely handle voting power snapshots.
